<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Navigating lineages · NCBITaxonomy</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NCBITaxonomy logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NCBITaxonomy</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Index</a></li><li><a class="tocitem" href="../namefinding/">Finding taxa</a></li><li class="is-active"><a class="tocitem" href>Navigating lineages</a><ul class="internal"><li><a class="tocitem" href="#Core-functions"><span>Core functions</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li><li><a class="tocitem" href="../portal/">Portal data use-case</a></li><li><a class="tocitem" href="../phylo/">Phylo.jl use-case</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Navigating lineages</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Navigating lineages</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/main/docs/src/lineages.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Navigating-lineages"><a class="docs-heading-anchor" href="#Navigating-lineages">Navigating lineages</a><a id="Navigating-lineages-1"></a><a class="docs-heading-anchor-permalink" href="#Navigating-lineages" title="Permalink"></a></h1><h2 id="Core-functions"><a class="docs-heading-anchor" href="#Core-functions">Core functions</a><a id="Core-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Core-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NCBITaxonomy.lineage" href="#NCBITaxonomy.lineage"><code>NCBITaxonomy.lineage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lineage(tax::NCBITaxon; stop_at::NCBITaxon=ncbi&quot;root&quot;)</code></pre><p>Returns an array of <code>NCBITaxon</code> going up to the root of the taxonomy, or to the optionally specified <code>stop_at</code> taxonomic node.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/d3d4884d9fbfda18cfbffedc35785ccf93ac799c/src/lineage/lineage.jl#L1-L6">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>AbstractTrees.children</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>AbstractTrees.parent</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="NCBITaxonomy.rank" href="#NCBITaxonomy.rank"><code>NCBITaxonomy.rank</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rank(taxon::NCBITaxon)</code></pre><p>Returns the rank of a taxon.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/d3d4884d9fbfda18cfbffedc35785ccf93ac799c/src/lineage/rank.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NCBITaxonomy.taxonomicdistance!" href="#NCBITaxonomy.taxonomicdistance!"><code>NCBITaxonomy.taxonomicdistance!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>This function fills a pre-allocated square matrix <code>D</code> with the taxonomic distance between taxa in a vector <code>tax</code>. The keywords areguments are <code>d</code> (the distance as a function to closest matching level), <code>strict</code> (a boolean to decide whether the distance of a taxon with itself should be read from the distance dictionary, or set to 0), and other keywords passed to the <code>lineage</code> function.</p><p>Because the distances are symetrical, there are only (n(n-1))/2 measurements to do.</p><p>By default, this function uses the distances from Shimatani (2001):</p><table><tr><th style="text-align: left">equal rank</th><th style="text-align: left">distance</th></tr><tr><td style="text-align: left">species</td><td style="text-align: left">0</td></tr><tr><td style="text-align: left">genus</td><td style="text-align: left">1</td></tr><tr><td style="text-align: left">family</td><td style="text-align: left">2</td></tr><tr><td style="text-align: left">subclass</td><td style="text-align: left">3</td></tr><tr><td style="text-align: left"><code>:fallback</code></td><td style="text-align: left">4</td></tr></table><p>Shimatani, K. 2001. On the measurement of species diversity incorporating species differences. Oikos 93:135–147.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/d3d4884d9fbfda18cfbffedc35785ccf93ac799c/src/utility/taxonomicdistance.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NCBITaxonomy.commonancestor" href="#NCBITaxonomy.commonancestor"><code>NCBITaxonomy.commonancestor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">commonancestor(tax::Vector{NCBITaxon})</code></pre><p>Returns the node corresponding to the last common ancestor of taxa in a vector. This function can be useful to speed up the iteration using the AbstractTrees interface, notably to find the right node to use for <code>descendantsfilter</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/d3d4884d9fbfda18cfbffedc35785ccf93ac799c/src/lineage/lineage.jl#L19-L25">source</a></section><section><div><pre><code class="nohighlight hljs">commonancestor(t1::NCBITaxon, t2::NCBITaxon)</code></pre><p>Returns the node corresponding to the last common ancestor of two taxa. This function can be useful to speed up the iteration using the AbstractTrees interface, notably to find the right node to use for <code>descendantsfilter</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PoisotLab/NCBITaxonomy.jl/blob/d3d4884d9fbfda18cfbffedc35785ccf93ac799c/src/lineage/lineage.jl#L30-L36">source</a></section></article><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>The <code>children</code> function will return a list of <code>NCBITaxon</code> that are immediately descending from the one given as argument. For example, the genus <em>Lamellodiscus</em> contains:</p><pre><code class="language- hljs">using NCBITaxonomy

ncbi&quot;Lamellodiscus&quot; |&gt; AbstractTrees.children</code></pre><p>Note that the <code>parent</code> function does the opposite of <code>children</code>:</p><pre><code class="language- hljs">ncbi&quot;Lamellodiscus kechemirae&quot; |&gt; AbstractTrees.parent</code></pre><p>To get the full descendants of a taxon (<em>i.e.</em> the children of its children, recursively), we can use the tree traversal opertions in <code>AbstractTrees</code>, <em>e.g.</em>:</p><pre><code class="language- hljs">AbstractTrees.PostOrderDFS(ncbi&quot;Diplectanidae&quot;)</code></pre><p>We can also work upwards in the taxonomy, using the <code>lineage</code> function – it takes an optional <code>stop_at</code> argument, which is the farther up it will go:</p><pre><code class="language-julia hljs">lineage(ncbi&quot;Lamellodiscus elegans&quot;; stop_at=ncbi&quot;Monogenea&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{NCBITaxon}:
 Monogenea (ncbi:37945)
 Monopisthocotylea (ncbi:37844)
 Dactylogyridea (ncbi:2486284)
 Diplectanidae (ncbi:67517)
 Lamellodiscus (ncbi:119230)
 Lamellodiscus elegans (ncbi:142933)</code></pre><p>The <code>rank</code> function is useful to know where in the taxonomy you are:</p><pre><code class="language-julia hljs">[t =&gt; rank(t) for t in lineage(ncbi&quot;Lamellodiscus elegans&quot;; stop_at=ncbi&quot;Monogenea&quot;)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Pair{NCBITaxon, Symbol}}:
              Monogenea (ncbi:37945) =&gt; :class
      Monopisthocotylea (ncbi:37844) =&gt; :subclass
       Dactylogyridea (ncbi:2486284) =&gt; :order
          Diplectanidae (ncbi:67517) =&gt; :family
         Lamellodiscus (ncbi:119230) =&gt; :genus
 Lamellodiscus elegans (ncbi:142933) =&gt; :species</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../namefinding/">« Finding taxa</a><a class="docs-footer-nextpage" href="../portal/">Portal data use-case »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 3 March 2023 20:42">Friday 3 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
